---
import Footer from "../../components/Footer/index.astro";
import Header from "../../components/Header/index.astro";

interface ISeo {
  title: string;
  description: string;
}

const { title, description } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="stylesheet" href="/css/css.css" />
    <link rel="stylesheet" href="/css/fazora.webflow.css" />

    <meta name="description" content={description} />
    <title>{title}</title>
    <script src="https://smartcaptcha.yandexcloud.net/captcha.js" defer
    ></script>
  </head>
  <Header slot="header" />
  <body>
    <slot name="header" />
    <slot />
    <slot name="footer" />
    <script src="/js/jquery-3.5.1.min.js" referrerpolicy="no-referrer"></script>
  </body>
  <Footer slot="footer" />
</html>

<style is:global>
  html {
    scroll-behavior: smooth;
  }
</style>

<script is:inline>
  document.addEventListener("click", (e) => {
    const link = e.target.closest('a[href="/"]');
    if (link) {
      if (window.location.pathname === "/") {
        e.preventDefault();
        window.scrollTo({ top: 0, behavior: "smooth" });
        history.pushState(null, "", "/");
      }
    }
  });

  document.addEventListener("click", function (e) {
    const backButton = e.target.closest(
      ".back-button, .helper.link, [data-back]",
    );

    if (backButton) {
      const link = backButton.closest("a");
      if (link) {
        e.preventDefault();

        if (document.referrer) {
          history.back();
        } else {
          window.location.href = link.href;
        }
      }
    }
  });

  document.addEventListener("click", function (e) {
    const link = e.target.closest("a");
    if (
      link &&
      link.href &&
      !link.classList.contains("back-button") &&
      !link.closest(".back-button")
    ) {
      sessionStorage.setItem("scrollPosition", window.scrollY);
      sessionStorage.setItem("scrollPath", window.location.pathname);
    }
  });

  (function () {
    const savedPosition = sessionStorage.getItem("scrollPosition");
    const savedPath = sessionStorage.getItem("scrollPath");

    if (savedPosition && savedPath === window.location.pathname) {
      window.scrollTo(0, parseInt(savedPosition));
      sessionStorage.removeItem("scrollPosition");
      sessionStorage.removeItem("scrollPath");
    }
  })();
</script>
